{
  "name": "Multi-Agent Development System version ULTRA v2",
  "nodes": [
    {
      "parameters": {
        "path": "dev-task",
        "formTitle": "ğŸš€ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸",
        "formDescription": "ĞœÑƒĞ»ÑŒÑ‚Ğ¸Ğ°Ğ³ĞµĞ½Ñ‚Ğ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°: Architect â†’ Code Writer â†’ Code Reviewer â†’ Documentation",
        "formFields": {
          "values": [
            {
              "fieldLabel": "ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸",
              "fieldType": "textarea",
              "placeholder": "Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ JWT-Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ...",
              "requiredField": true
            },
            {
              "fieldLabel": "Ğ’Ğ»Ğ°Ğ´ĞµĞ»ĞµÑ† Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ",
              "placeholder": "username",
              "defaultValue": "kaze-nomi",
              "requiredField": true
            },
            {
              "fieldLabel": "ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ",
              "placeholder": "my-repo",
              "defaultValue": "MultiAgentIntelligentSystem",
              "requiredField": true
            },
            {
              "fieldLabel": "ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ğ²ĞµÑ‚ĞºĞ°",
              "placeholder": "main",
              "defaultValue": "main"
            }
          ]
        },
        "options": {}
      },
      "id": "98e14544-85cf-4d3e-9cdd-eabaee3ef78f",
      "name": "ğŸ“ Task Input",
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.1,
      "position": [-3520, 128],
      "webhookId": "dev-task"
    },
    {
      "parameters": {
        "jsCode": "const form = $input.first().json;\n\nreturn [{\n  json: {\n    task_description: form['ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸'],\n    repo_owner: form['Ğ’Ğ»Ğ°Ğ´ĞµĞ»ĞµÑ† Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ'],\n    repo_name: form['ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ'],\n    base_branch: form['ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ğ²ĞµÑ‚ĞºĞ°'] || 'main'\n  }\n}];"
      },
      "id": "7778493b-6439-494b-88dc-8aa58f1ee4e2",
      "name": "ğŸ“‹ Prepare Data",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-3296, 128]
    },
    {
      "parameters": {
        "url": "=https://api.github.com/repos/{{ $json.repo_owner }}/{{ $json.repo_name }}/git/trees/{{ $json.base_branch }}?recursive=1",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "options": {
          "timeout": 30000
        }
      },
      "id": "722b2b76-26ea-454c-bf68-97bda480a430",
      "name": "ğŸ“‚ Get Repo Structure",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-3088, 128],
      "credentials": {
        "githubApi": {
          "id": "EuDjNHcUwsanYUOc",
          "name": "GitHub account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const formData = $('ğŸ“‹ Prepare Data').first().json;\nconst treeResponse = $input.first().json;\n\n// Ğ›Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµĞ¼ Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸\nconsole.log('Tree response keys:', Object.keys(treeResponse));\nconsole.log('Tree array length:', (treeResponse.tree || []).length);\nconsole.log('First 3 items:', JSON.stringify((treeResponse.tree || []).slice(0, 3), null, 2));\n\n// ĞŸĞ°Ñ€ÑĞ¸Ğ¼ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ\nconst structure = (treeResponse.tree || []).map(item => ({\n  path: item.path,\n  type: item.type === 'blob' ? 'file' : 'dir',\n  originalType: item.type,\n  size: item.size || 0,\n  sha: item.sha\n}));\n\n// Ğ ĞĞ¡Ğ¨Ğ˜Ğ Ğ•ĞĞĞ«Ğ• Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹ Ğ´Ğ»Ñ ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²\nconst keyPatterns = [\n  /^readme\\.md$/i,\n  /^changelog\\.md$/i,\n  /^contributing\\.md$/i,\n  /^package\\.json$/,\n  /^package-lock\\.json$/,\n  /^requirements\\.txt$/,\n  /^pyproject\\.toml$/,\n  /^setup\\.py$/,\n  /^setup\\.cfg$/,\n  /^poetry\\.lock$/,\n  /^Pipfile$/,\n  /^docker-compose\\.ya?ml$/,\n  /^Dockerfile$/i,\n  /^dockerfile$/i,\n  /^\\.env\\.example$/,\n  /^\\.env\\.sample$/,\n  /^tsconfig\\.json$/,\n  /^vite\\.config\\.(js|ts)$/,\n  /^webpack\\.config\\.js$/,\n  /^next\\.config\\.(js|mjs)$/,\n  /^nuxt\\.config\\.(js|ts)$/,\n  /^\\.eslintrc(\\.(js|json|yml))?$/,\n  /^\\.prettierrc(\\.(js|json|yml))?$/,\n  /^tailwind\\.config\\.(js|ts)$/,\n  /^cargo\\.toml$/i,\n  /^go\\.mod$/,\n  /^go\\.sum$/,\n  /^makefile$/i,\n  /^justfile$/i,\n  /^main\\.(py|js|ts|go|rs)$/,\n  /^index\\.(py|js|ts|tsx|jsx)$/,\n  /^app\\.(py|js|ts|tsx|jsx)$/,\n  /^server\\.(py|js|ts)$/,\n  /^run\\.(py|js|ts)$/,\n  /^cli\\.(py|js|ts)$/,\n  /\\.py$/,\n  /^src\\/.*\\.(js|jsx|ts|tsx)$/,\n  /^lib\\/.*\\.(js|jsx|ts|tsx)$/,\n  /^app\\/.*\\.(js|jsx|ts|tsx)$/,\n  /^pages\\/.*\\.(js|jsx|ts|tsx)$/,\n  /^components\\/.*\\.(js|jsx|ts|tsx)$/,\n  /^hooks\\/.*\\.(js|jsx|ts|tsx)$/,\n  /^utils\\/.*\\.(js|ts)$/,\n  /^helpers\\/.*\\.(js|ts)$/,\n  /^services\\/.*\\.(js|ts)$/,\n  /^api\\/.*\\.(js|ts)$/,\n  /^routes?\\/.*\\.(js|ts)$/,\n  /^controllers?\\/.*\\.(js|ts)$/,\n  /^middleware\\/.*\\.(js|ts)$/,\n  /^models?\\/.*\\.(js|ts)$/,\n  /^schemas?\\/.*\\.(js|ts)$/,\n  /^types?\\/.*\\.(ts|d\\.ts)$/,\n  /^store\\/.*\\.(js|ts)$/,\n  /^config\\/.*\\.(js|ts|json)$/,\n  /\\.go$/,\n  /\\.rs$/,\n  /\\.cpp$/,\n  /\\.cxx$/,\n  /\\.c$/,\n  /\\.java$/,\n  /build\\.gradle\\.kts$/,\n  /pom\\.xml$/,\n  /config\\/.*\\.(json|ya?ml|toml)$/,\n  /\\.github\\/workflows\\/.*\\.ya?ml$/\n];\n\n// ĞŸĞ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹ Ğ´Ğ»Ñ Ğ˜Ğ¡ĞšĞ›Ğ®Ğ§Ğ•ĞĞ˜Ğ¯\nconst excludePatterns = [\n  /node_modules\\//,\n  /\\.git\\//,\n  /dist\\//,\n  /build\\//,\n  /\\.next\\//,\n  /\\.nuxt\\//,\n  /out\\//,\n  /__pycache__\\//,\n  /\\.pytest_cache\\//,\n  /\\.mypy_cache\\//,\n  /\\.ruff_cache\\//,\n  /\\.venv\\//,\n  /venv\\//,\n  /\\.env\\//,\n  /env\\//,\n  /virtualenv\\//,\n  /\\.tox\\//,\n  /\\.eggs\\//,\n  /\\.egg-info\\//,\n  /htmlcov\\//,\n  /coverage\\//,\n  /\\.coverage/,\n  /\\.cache\\//,\n  /\\.temp\\//,\n  /\\.tmp\\//,\n  /target\\//,\n  /vendor\\//,\n  /\\.idea\\//,\n  /\\.vscode\\//,\n  /\\.DS_Store/,\n  /Thumbs\\.db/,\n  /\\.log$/,\n  /\\.min\\.(js|css)$/,\n  /\\.map$/,\n  /\\.bundle\\.(js|css)$/,\n  /test_.*\\.py$/,\n  /.*_test\\.py$/,\n  /.*\\.test\\.(js|ts|jsx|tsx)$/,\n  /.*\\.spec\\.(js|ts|jsx|tsx)$/,\n  /__tests__\\//,\n  /tests?\\//\n];\n\n// ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹\nconst priorityPatterns = [\n  /^readme\\.md$/i,\n  /^package\\.json$/,\n  /^requirements\\.txt$/,\n  /^pyproject\\.toml$/,\n  /^main\\.(py|js|ts)$/,\n  /^index\\.(py|js|ts)$/,\n  /^app\\.(py|js|ts)$/,\n  /^server\\.(py|js|ts)$/,\n  /models?\\.py$/,\n  /schema\\.py$/\n];\n\nconst allFiles = structure.filter(item => {\n  if (item.type !== 'file') return false;\n  if (item.size > 100000) return false;\n  const isExcluded = excludePatterns.some(p => p.test(item.path));\n  if (isExcluded) return false;\n  const matchesKey = keyPatterns.some(p => p.test(item.path));\n  return matchesKey;\n});\n\nconst sortedFiles = allFiles.sort((a, b) => {\n  const aPriority = priorityPatterns.some(p => p.test(a.path)) ? 0 : 1;\n  const bPriority = priorityPatterns.some(p => p.test(b.path)) ? 0 : 1;\n  if (aPriority !== bPriority) return aPriority - bPriority;\n  return a.size - b.size;\n});\n\nconst filesToFetch = sortedFiles.slice(0, 50);\n\n// Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ SHA Ğ´Ğ»Ñ Ğ’Ğ¡Ğ•Ğ¥ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²\nconst existingFileShas = {};\nstructure.forEach(item => {\n  if (item.type === 'file') {\n    existingFileShas[item.path] = item.sha;\n  }\n});\n\nconsole.log('=== FINAL STATS ===');\nconsole.log(`Total items in structure: ${structure.length}`);\nconsole.log(`Total files: ${structure.filter(i => i.type === 'file').length}`);\nconsole.log(`Files matching patterns: ${allFiles.length}`);\nconsole.log(`Files to fetch: ${filesToFetch.length}`);\n\nreturn [{\n  json: {\n    ...formData,\n    structure: structure,\n    files_to_fetch: filesToFetch,\n    existing_file_shas: existingFileShas,\n    stats: {\n      total_files: structure.filter(i => i.type === 'file').length,\n      matching_files: allFiles.length,\n      files_to_fetch: filesToFetch.length\n    }\n  }\n}];"
      },
      "id": "49d290ae-d35b-4c43-850e-ae2072297e4f",
      "name": "ğŸ” Analyze Structure",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-2864, 128]
    },
    {
      "parameters": {
        "jsCode": "const data = $input.first().json;\nconst filesToFetch = data.files_to_fetch || [];\n\nif (filesToFetch.length === 0) {\n  return [{ json: { ...data, skip_fetch: true } }];\n}\n\nreturn filesToFetch.map(file => ({\n  json: { ...data, file_path: file.path, file_sha: file.sha }\n}));"
      },
      "id": "e6b6f99e-41f3-4f99-956d-3062d596f42e",
      "name": "ğŸ“„ Split Files",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-2640, 128]
    },
    {
      "parameters": {
        "url": "=https://api.github.com/repos/{{ $json.repo_owner }}/{{ $json.repo_name }}/contents/{{ $json.file_path }}?ref={{ $json.base_branch }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "options": {
          "batching": {
            "batch": {
              "batchSize": 1
            }
          },
          "timeout": 20000
        }
      },
      "id": "5c429daa-8675-437a-a9f1-ccbb698407fd",
      "name": "ğŸ“¥ Fetch Contents",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-2416, 128],
      "credentials": {
        "githubApi": {
          "id": "EuDjNHcUwsanYUOc",
          "name": "GitHub account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\nconst firstItem = $('ğŸ” Analyze Structure').first().json;\n\nconst keyFiles = {};\nlet loaded = 0, failed = 0;\n\nitems.forEach(item => {\n  if (item.json.skip_fetch) return;\n  try {\n    const content = item.json.content;\n    const path = item.json.path || item.json.name;\n    if (content && path) {\n      keyFiles[path] = Buffer.from(content, 'base64').toString('utf-8');\n      loaded++;\n    }\n  } catch (e) { failed++; }\n});\n\nreturn [{\n  json: {\n    task_description: firstItem.task_description,\n    repo_owner: firstItem.repo_owner,\n    repo_name: firstItem.repo_name,\n    base_branch: firstItem.base_branch,\n    existing_file_shas: firstItem.existing_file_shas,\n    repo_context: { structure: firstItem.structure, key_files: keyFiles },\n    files_loaded: loaded\n  }\n}];"
      },
      "id": "dffe7ccc-b02d-42bb-8b2e-6a1cc08bee25",
      "name": "ğŸ“¦ Aggregate Contents",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-2208, 128]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://project-manager:8000/workflow/process",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ task_description: $json.task_description, repo_owner: $json.repo_owner, repo_name: $json.repo_name, base_branch: $json.base_branch, repo_context: $json.repo_context, priority: 'high', max_review_iterations: 3 }) }}",
        "options": {
          "timeout": 600000
        }
      },
      "id": "631546d7-ce42-4224-81b7-d1d259c48a69",
      "name": "ğŸ¤– Call Project Manager",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-1984, 128]
    },
    {
      "parameters": {
        "jsCode": "const aggregateData = $('ğŸ“¦ Aggregate Contents').first().json;\nconst pmResponse = $input.first().json;\n\nif (pmResponse.status === 'failed') {\n  const errors = pmResponse.errors || [];\n  const agentResults = pmResponse.agent_results || {};\n  \n  let errorDetails = 'Pipeline failed:\\n';\n  \n  if (agentResults.code_writer) {\n    const cw = agentResults.code_writer;\n    if (!cw.files || cw.files.length === 0) {\n      errorDetails += 'âŒ Code Writer: No files generated\\n';\n      if (cw.implementation_notes) {\n        errorDetails += `   Notes: ${cw.implementation_notes.join(', ')}\\n`;\n      }\n    }\n  }\n  \n  errors.forEach(e => {\n    errorDetails += `âŒ ${e.step}: ${e.error}\\n`;\n  });\n}\n\nconst files = pmResponse.files_to_create || [];\nif (files.length === 0) {\n  $input.first().json.status = 'failed';\n}\n\nreturn [{\n  json: {\n    ...pmResponse,\n    repo_owner: aggregateData.repo_owner,\n    repo_name: aggregateData.repo_name,\n    base_branch: aggregateData.base_branch,\n    existing_file_shas: aggregateData.existing_file_shas\n  }\n}];"
      },
      "id": "91cae53b-980b-4c1a-959b-62e83bd07bab",
      "name": "âœ… Check PM Response",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-1760, 128]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": false,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 1
          },
          "conditions": [
            {
              "leftValue": "={{ $json.status }}",
              "rightValue": "failed",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              },
              "id": "2c921d36-eed4-45a6-8451-1939794200a1"
            },
            {
              "id": "2d422828-3a90-4be4-83b0-04d98231e755",
              "leftValue": "={{ $json.status }}",
              "rightValue": "error",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {
          "ignoreCase": true,
          "looseTypeValidation": true
        }
      },
      "id": "b6d6086f-cb87-4517-8076-7107ec2688ea",
      "name": "ğŸ”€ Is Success?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [-1552, 128]
    },
    {
      "parameters": {
        "url": "=https://api.github.com/repos/{{ $json.repo_owner }}/{{ $json.repo_name }}/git/refs/heads/{{ $json.base_branch }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "options": {}
      },
      "id": "9fab2454-8694-456c-abbf-50e7998d5c07",
      "name": "ğŸ”— Get Base SHA",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-1296, 0],
      "credentials": {
        "githubApi": {
          "id": "EuDjNHcUwsanYUOc",
          "name": "GitHub account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const pmData = $('âœ… Check PM Response').first().json;\nconst shaResponse = $input.first().json;\n\nreturn [{ json: { ...pmData, base_sha: shaResponse.object.sha } }];"
      },
      "id": "ef7670a1-7bab-40a3-a085-ebc75170c948",
      "name": "Extract SHA",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-1088, 0]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.github.com/repos/{{ $json.repo_owner }}/{{ $json.repo_name }}/git/refs",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ ref: 'refs/heads/' + $json.branch_name, sha: $json.base_sha }) }}",
        "options": {}
      },
      "id": "49242abe-b468-439e-a808-192101f44c0d",
      "name": "ğŸŒ¿ Create Branch",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-864, 0],
      "credentials": {
        "githubApi": {
          "id": "EuDjNHcUwsanYUOc",
          "name": "GitHub account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// =====================================================\n// ğŸ”§ Ğ˜ĞĞ˜Ğ¦Ğ˜ĞĞ›Ğ˜Ğ—ĞĞ¦Ğ˜Ğ¯ RETRY LOOP\n// =====================================================\nconst data = $('Extract SHA').first().json;\nconst files = data.files_to_create || [];\nconst existingShas = data.existing_file_shas || {};\n\nif (files.length === 0) {\n  throw new Error('No files to create!');\n}\n\n// Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµĞ¼ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ Ğ´Ğ»Ñ retry\nconst filesToProcess = files.map((file, index) => {\n  const existingSha = existingShas[file.path];\n  return {\n    path: file.path,\n    content: file.content || '',\n    action: file.action || 'create',\n    source_agent: file.source_agent || 'unknown',\n    existing_sha: existingSha || null,\n    status: 'pending',  // pending, success, failed\n    attempts: 0,\n    last_error: null\n  };\n});\n\nreturn [{\n  json: {\n    repo_owner: data.repo_owner,\n    repo_name: data.repo_name,\n    branch_name: data.branch_name,\n    base_branch: data.base_branch,\n    commit_message: data.commit_message,\n    pr_title: data.pr_title,\n    pr_description: data.pr_description,\n    summary: data.summary,\n    task_id: data.task_id,\n    tech_stack: data.tech_stack,\n    review_iterations: data.review_iterations,\n    agent_results: data.agent_results,\n    // Retry state\n    files_to_process: filesToProcess,\n    created_files: [],  // Ğ£ÑĞ¿ĞµÑˆĞ½Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ\n    failed_files: [],   // ĞĞºĞ¾Ğ½Ñ‡Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ failed\n    current_attempt: 1,\n    max_attempts: 3\n  }\n}];"
      },
      "id": "init-retry-loop",
      "name": "ğŸ”„ Init Retry Loop",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-640, 0]
    },
    {
      "parameters": {
        "jsCode": "// =====================================================\n// ğŸ“„ SPLIT: ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ pending Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ´Ğ»Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸\n// =====================================================\nconst data = $input.first().json;\nconst pendingFiles = data.files_to_process.filter(f => f.status === 'pending');\n\nconsole.log(`Attempt ${data.current_attempt}/${data.max_attempts}: ${pendingFiles.length} files to process`);\n\nif (pendingFiles.length === 0) {\n  // Ğ’ÑĞµ Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ñ‹ - Ğ¸Ğ´Ñ‘Ğ¼ Ğ´Ğ°Ğ»ÑŒÑˆĞµ\n  return [{ json: { ...data, all_processed: true } }];\n}\n\n// Ğ Ğ°Ğ·Ğ±Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ½Ğ° Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğµ items Ğ´Ğ»Ñ Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸\nreturn pendingFiles.map(file => ({\n  json: {\n    ...data,\n    current_file: file,\n    all_processed: false\n  }\n}));"
      },
      "id": "split-pending-files",
      "name": "ğŸ“„ Split Pending Files",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-416, 0]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "check-all-processed",
              "leftValue": "={{ $json.all_processed }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "check-all-done",
      "name": "ğŸ”€ All Processed?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [-192, 0]
    },
    {
      "parameters": {
        "url": "=https://api.github.com/repos/{{ $json.repo_owner }}/{{ $json.repo_name }}/contents/{{ $json.current_file.path }}?ref={{ $json.branch_name }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "options": {
          "timeout": 15000
        }
      },
      "id": "get-file-sha",
      "name": "ğŸ” Get File SHA",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [32, -128],
      "credentials": {
        "githubApi": {
          "id": "EuDjNHcUwsanYUOc",
          "name": "GitHub account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// =====================================================\n// ğŸ“ PREPARE: ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ PUT\n// =====================================================\nconst data = $input.first().json;\nconst file = data.current_file;\n\n// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ğ»Ğ¸ Ğ»Ğ¸ Ğ¼Ñ‹ SHA (Ñ„Ğ°Ğ¹Ğ» ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚)\nlet fileSha = null;\nif (data.sha) {\n  // Ğ¤Ğ°Ğ¹Ğ» ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ½Ğ° Ğ²ĞµÑ‚ĞºĞµ - Ğ½ÑƒĞ¶ĞµĞ½ SHA Ğ´Ğ»Ñ update\n  fileSha = data.sha;\n  console.log(`File exists: ${file.path}, SHA: ${fileSha}`);\n} else if (file.existing_sha) {\n  // Ğ¤Ğ°Ğ¹Ğ» ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ² base branch\n  fileSha = file.existing_sha;\n  console.log(`Using existing SHA for ${file.path}: ${fileSha}`);\n} else {\n  console.log(`New file: ${file.path}`);\n}\n\nconst contentBase64 = Buffer.from(file.content).toString('base64');\n\nreturn [{\n  json: {\n    repo_owner: data.repo_owner,\n    repo_name: data.repo_name,\n    branch_name: data.branch_name,\n    base_branch: data.base_branch,\n    commit_message: data.commit_message,\n    pr_title: data.pr_title,\n    pr_description: data.pr_description,\n    summary: data.summary,\n    task_id: data.task_id,\n    tech_stack: data.tech_stack,\n    review_iterations: data.review_iterations,\n    agent_results: data.agent_results,\n    files_to_process: data.files_to_process,\n    created_files: data.created_files,\n    failed_files: data.failed_files,\n    current_attempt: data.current_attempt,\n    max_attempts: data.max_attempts,\n    // Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ PUT\n    current_file: {\n      ...file,\n      resolved_sha: fileSha\n    },\n    file_path: file.path,\n    file_content_base64: contentBase64,\n    file_sha: fileSha\n  }\n}];"
      },
      "id": "prepare-put-data",
      "name": "ğŸ“ Prepare PUT Data",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [256, -128]
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://api.github.com/repos/{{ $json.repo_owner }}/{{ $json.repo_name }}/contents/{{ $json.file_path }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ (() => {\n  const body = {\n    message: $json.commit_message + ' [' + $json.file_path.split('/').pop() + ']',\n    content: $json.file_content_base64,\n    branch: $json.branch_name\n  };\n  if ($json.file_sha) {\n    body.sha = $json.file_sha;\n  }\n  return JSON.stringify(body);\n})() }}",
        "options": {
          "timeout": 30000
        }
      },
      "id": "create-update-file",
      "name": "ğŸ’¾ Create/Update File",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [480, -128],
      "credentials": {
        "githubApi": {
          "id": "EuDjNHcUwsanYUOc",
          "name": "GitHub account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// =====================================================\n// ğŸ“Š PROCESS RESULT: ĞĞ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ PUT\n// =====================================================\nconst items = $input.all();\nconst firstData = $('ğŸ“„ Split Pending Files').first().json;\n\n// Ğ¡Ğ¾Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹\nconst results = items.map(item => {\n  const data = item.json;\n  const file = data.current_file;\n  const path = file?.path || data.file_path;\n  \n  // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ÑƒÑĞ¿ĞµÑ…\n  if (data.content && data.commit) {\n    return { path, status: 'success', sha: data.content.sha };\n  } else {\n    const error = data.message || data.error || 'Unknown error';\n    return { path, status: 'failed', error };\n  }\n});\n\n// ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²\nconst updatedFiles = firstData.files_to_process.map(f => {\n  const result = results.find(r => r.path === f.path);\n  if (result) {\n    if (result.status === 'success') {\n      return { ...f, status: 'success', new_sha: result.sha };\n    } else {\n      return { \n        ...f, \n        attempts: f.attempts + 1,\n        last_error: result.error,\n        status: f.attempts + 1 >= firstData.max_attempts ? 'failed' : 'pending'\n      };\n    }\n  }\n  return f;\n});\n\n// ĞŸĞ¾Ğ´ÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ\nconst successCount = updatedFiles.filter(f => f.status === 'success').length;\nconst pendingCount = updatedFiles.filter(f => f.status === 'pending').length;\nconst failedCount = updatedFiles.filter(f => f.status === 'failed').length;\n\nconsole.log(`After attempt ${firstData.current_attempt}: success=${successCount}, pending=${pendingCount}, failed=${failedCount}`);\n\n// Ğ•ÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ pending Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ¸ Ğ½Ğµ Ğ¿Ñ€ĞµĞ²Ñ‹ÑĞ¸Ğ»Ğ¸ Ğ»Ğ¸Ğ¼Ğ¸Ñ‚ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº - Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°ĞµĞ¼\nconst needRetry = pendingCount > 0 && firstData.current_attempt < firstData.max_attempts;\n\nreturn [{\n  json: {\n    repo_owner: firstData.repo_owner,\n    repo_name: firstData.repo_name,\n    branch_name: firstData.branch_name,\n    base_branch: firstData.base_branch,\n    commit_message: firstData.commit_message,\n    pr_title: firstData.pr_title,\n    pr_description: firstData.pr_description,\n    summary: firstData.summary,\n    task_id: firstData.task_id,\n    tech_stack: firstData.tech_stack,\n    review_iterations: firstData.review_iterations,\n    agent_results: firstData.agent_results,\n    files_to_process: updatedFiles,\n    current_attempt: firstData.current_attempt + 1,\n    max_attempts: firstData.max_attempts,\n    // Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°\n    success_count: successCount,\n    pending_count: pendingCount,\n    failed_count: failedCount,\n    need_retry: needRetry,\n    all_done: !needRetry\n  }\n}];"
      },
      "id": "process-results",
      "name": "ğŸ“Š Process Results",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [704, -128]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "need-retry",
              "leftValue": "={{ $json.need_retry }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "check-need-retry",
      "name": "ğŸ”€ Need Retry?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [928, -128]
    },
    {
      "parameters": {
        "jsCode": "// =====================================================\n// â³ WAIT: ĞĞµĞ±Ğ¾Ğ»ÑŒÑˆĞ°Ñ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ¿ĞµÑ€ĞµĞ´ retry\n// =====================================================\nconst data = $input.first().json;\n\nconsole.log(`Waiting before retry attempt ${data.current_attempt}...`);\n\n// ĞŸÑ€Ğ¾ÑÑ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµĞ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ»ÑŒÑˆĞµ\nreturn [{ json: data }];"
      },
      "id": "wait-before-retry",
      "name": "â³ Wait & Retry",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1152, -256]
    },
    {
      "parameters": {
        "jsCode": "// =====================================================\n// âœ… FINALIZE: Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²\n// =====================================================\nconst data = $input.first().json;\nconst files = data.files_to_process || [];\n\nconst successFiles = files.filter(f => f.status === 'success');\nconst failedFiles = files.filter(f => f.status === 'failed');\n\nconsole.log(`Final: ${successFiles.length} success, ${failedFiles.length} failed`);\n\n// Ğ•ÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ failed Ñ„Ğ°Ğ¹Ğ»Ñ‹ - ÑÑ‚Ğ¾ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°\nconst hasErrors = failedFiles.length > 0;\n\nreturn [{\n  json: {\n    ...data,\n    files_created: successFiles.length,\n    files_failed: failedFiles.length,\n    success_files: successFiles.map(f => f.path),\n    failed_files_details: failedFiles.map(f => ({\n      path: f.path,\n      error: f.last_error,\n      attempts: f.attempts\n    })),\n    has_errors: hasErrors,\n    can_create_pr: successFiles.length > 0  // PR Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞµÑĞ»Ğ¸ Ñ…Ğ¾Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾-Ñ‚Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ğ»Ğ¾ÑÑŒ\n  }\n}];"
      },
      "id": "finalize-results",
      "name": "âœ… Finalize Results",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1152, 0]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "can-pr",
              "leftValue": "={{ $json.can_create_pr }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "check-can-pr",
      "name": "ğŸ”€ Can Create PR?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [1376, 0]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.github.com/repos/{{ $json.repo_owner }}/{{ $json.repo_name }}/pulls",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ title: $json.pr_title, head: $json.branch_name, base: $json.base_branch, body: $json.pr_description }) }}",
        "options": {}
      },
      "id": "create-pr",
      "name": "ğŸ”€ Create PR",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1600, -128],
      "credentials": {
        "githubApi": {
          "id": "EuDjNHcUwsanYUOc",
          "name": "GitHub account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const data = $('âœ… Finalize Results').first().json;\nconst pr = $input.first().json;\n\nlet msg = `âœ… *Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ°!*\\n\\n`;\nmsg += `${data.summary}\\n\\n`;\n\n// Ğ¤Ğ°Ğ¹Ğ»Ñ‹\nmsg += `ğŸ“ *Ğ¤Ğ°Ğ¹Ğ»Ñ‹:*\\n`;\nmsg += `â€¢ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¾: ${data.files_created}\\n`;\nif (data.files_failed > 0) {\n  msg += `â€¢ âš ï¸ ĞÑˆĞ¸Ğ±ĞºĞ¸: ${data.files_failed}\\n`;\n  data.failed_files_details.forEach(f => {\n    msg += `  - ${f.path}: ${f.error} (${f.attempts} Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº)\\n`;\n  });\n}\n\n// ĞĞ³ĞµĞ½Ñ‚Ñ‹\nconst agents = data.agent_results || {};\nmsg += `\\nğŸ¤– *ĞĞ³ĞµĞ½Ñ‚Ñ‹:*\\n`;\nif (agents.architect?.components) {\n  msg += `â€¢ Architect: ${agents.architect.components.length} ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²\\n`;\n}\nif (agents.code_writer?.files) {\n  msg += `â€¢ Code Writer: ${agents.code_writer.files.length} Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²\\n`;\n}\nif (agents.code_reviewer?.result) {\n  const score = agents.code_reviewer.result.quality_score || 0;\n  msg += `â€¢ Code Reviewer: ${score}/10 Ğ±Ğ°Ğ»Ğ»Ğ¾Ğ²\\n`;\n}\nif (agents.documentation?.files) {\n  msg += `â€¢ Documentation: ${agents.documentation.files.length} Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²\\n`;\n}\n\nmsg += `\\nğŸ”— [Pull Request #${pr.number}](${pr.html_url})`;\n\nreturn [{ json: { message: msg } }];"
      },
      "id": "success-message",
      "name": "ğŸ“± Success Message",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1824, -128]
    },
    {
      "parameters": {
        "jsCode": "const data = $input.first().json;\n\nlet msg = `âŒ *ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²*\\n\\n`;\nmsg += `ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ½Ğ¸ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ¿Ğ¾ÑĞ»Ğµ ${data.max_attempts} Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº.\\n\\n`;\n\nmsg += `ğŸ“ *ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹:*\\n`;\ndata.failed_files_details.forEach(f => {\n  msg += `â€¢ \\`${f.path}\\`\\n`;\n  msg += `  ĞÑˆĞ¸Ğ±ĞºĞ°: ${f.error}\\n`;\n  msg += `  ĞŸĞ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº: ${f.attempts}\\n\\n`;\n});\n\nmsg += `\\nğŸ’¡ *Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ñ‡Ğ¸Ğ½Ñ‹:*\\n`;\nmsg += `â€¢ Ğ¤Ğ°Ğ¹Ğ» Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½\\n`;\nmsg += `â€¢ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ñ Ğ¿Ñ€Ğ°Ğ²Ğ°Ğ¼Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°\\n`;\nmsg += `â€¢ Rate limit GitHub API\\n`;\n\nreturn [{ json: { message: msg } }];"
      },
      "id": "total-failure-message",
      "name": "ğŸ“± Total Failure Message",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1600, 128]
    },
    {
      "parameters": {
        "chatId": "=6487984216",
        "text": "={{ $json.message }}",
        "additionalFields": {
          "disable_web_page_preview": true,
          "parse_mode": "Markdown"
        }
      },
      "id": "send-success",
      "name": "ğŸ“¤ Send Success",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [2048, -128],
      "credentials": {
        "telegramApi": {
          "id": "kakDfZD7GZ0uQLva",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "=6487984216",
        "text": "={{ $json.message }}",
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "id": "send-failure",
      "name": "ğŸ“¤ Send Failure",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [1824, 128],
      "credentials": {
        "telegramApi": {
          "id": "kakDfZD7GZ0uQLva",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const data = $('âœ… Check PM Response').first().json;\n\nlet msg = `âŒ *Pipeline Failed*\\n\\n`;\nmsg += `${data.summary || 'No summary available'}\\n\\n`;\n\nif (data.errors) {\n  msg += `*ĞÑˆĞ¸Ğ±ĞºĞ¸:*\\n`;\n  data.errors.forEach(e => {\n    msg += `â€¢ ${e.step}: ${e.error}\\n`;\n  });\n}\n\nreturn [{ json: { message: msg } }];"
      },
      "id": "pm-error-message",
      "name": "ğŸ“± PM Error Message",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-1296, 256]
    },
    {
      "parameters": {
        "chatId": "=6487984216",
        "text": "={{ $json.message }}",
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "id": "send-pm-error",
      "name": "ğŸ“¤ Send PM Error",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [-1088, 256],
      "credentials": {
        "telegramApi": {
          "id": "kakDfZD7GZ0uQLva",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {},
      "id": "end-success",
      "name": "âœ… End Success",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [2272, -128]
    },
    {
      "parameters": {},
      "id": "end-failure",
      "name": "âŒ End Failure",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [2048, 128]
    },
    {
      "parameters": {},
      "id": "end-pm-error",
      "name": "âŒ End PM Error",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [-864, 256]
    }
  ],
  "pinData": {},
  "connections": {
    "ğŸ“ Task Input": {
      "main": [
        [
          {
            "node": "ğŸ“‹ Prepare Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‹ Prepare Data": {
      "main": [
        [
          {
            "node": "ğŸ“‚ Get Repo Structure",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‚ Get Repo Structure": {
      "main": [
        [
          {
            "node": "ğŸ” Analyze Structure",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ” Analyze Structure": {
      "main": [
        [
          {
            "node": "ğŸ“„ Split Files",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“„ Split Files": {
      "main": [
        [
          {
            "node": "ğŸ“¥ Fetch Contents",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“¥ Fetch Contents": {
      "main": [
        [
          {
            "node": "ğŸ“¦ Aggregate Contents",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“¦ Aggregate Contents": {
      "main": [
        [
          {
            "node": "ğŸ¤– Call Project Manager",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¤– Call Project Manager": {
      "main": [
        [
          {
            "node": "âœ… Check PM Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âœ… Check PM Response": {
      "main": [
        [
          {
            "node": "ğŸ”€ Is Success?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ Is Success?": {
      "main": [
        [
          {
            "node": "ğŸ”— Get Base SHA",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ğŸ“± PM Error Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”— Get Base SHA": {
      "main": [
        [
          {
            "node": "Extract SHA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract SHA": {
      "main": [
        [
          {
            "node": "ğŸŒ¿ Create Branch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸŒ¿ Create Branch": {
      "main": [
        [
          {
            "node": "ğŸ”„ Init Retry Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”„ Init Retry Loop": {
      "main": [
        [
          {
            "node": "ğŸ“„ Split Pending Files",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“„ Split Pending Files": {
      "main": [
        [
          {
            "node": "ğŸ”€ All Processed?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ All Processed?": {
      "main": [
        [
          {
            "node": "âœ… Finalize Results",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ğŸ” Get File SHA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ” Get File SHA": {
      "main": [
        [
          {
            "node": "ğŸ“ Prepare PUT Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“ Prepare PUT Data": {
      "main": [
        [
          {
            "node": "ğŸ’¾ Create/Update File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ’¾ Create/Update File": {
      "main": [
        [
          {
            "node": "ğŸ“Š Process Results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“Š Process Results": {
      "main": [
        [
          {
            "node": "ğŸ”€ Need Retry?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ Need Retry?": {
      "main": [
        [
          {
            "node": "â³ Wait & Retry",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "âœ… Finalize Results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "â³ Wait & Retry": {
      "main": [
        [
          {
            "node": "ğŸ“„ Split Pending Files",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âœ… Finalize Results": {
      "main": [
        [
          {
            "node": "ğŸ”€ Can Create PR?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ Can Create PR?": {
      "main": [
        [
          {
            "node": "ğŸ”€ Create PR",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ğŸ“± Total Failure Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ Create PR": {
      "main": [
        [
          {
            "node": "ğŸ“± Success Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“± Success Message": {
      "main": [
        [
          {
            "node": "ğŸ“¤ Send Success",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“± Total Failure Message": {
      "main": [
        [
          {
            "node": "ğŸ“¤ Send Failure",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“¤ Send Success": {
      "main": [
        [
          {
            "node": "âœ… End Success",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“¤ Send Failure": {
      "main": [
        [
          {
            "node": "âŒ End Failure",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“± PM Error Message": {
      "main": [
        [
          {
            "node": "ğŸ“¤ Send PM Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“¤ Send PM Error": {
      "main": [
        [
          {
            "node": "âŒ End PM Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "v2-retry-logic",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "28f87a46502090a63d81c1b0d194b30cb85aa507eb30004f35c39d5a49ec1f61"
  },
  "id": "2IfP47njK9Hr0TPZ",
  "tags": []
}