{
  "name": "Multi-Agent Development System",
  "nodes": [
    {
      "parameters": {
        "path": "dev-task",
        "formTitle": "üöÄ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏",
        "formDescription": "–ú—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: Architect ‚Üí Code Writer ‚Üí Code Reviewer ‚Üí Documentation",
        "formFields": {
          "values": [
            {
              "fieldLabel": "–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏",
              "fieldType": "textarea",
              "placeholder": "–î–æ–±–∞–≤–∏—Ç—å JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é...",
              "requiredField": true
            },
            {
              "fieldLabel": "–í–ª–∞–¥–µ–ª–µ—Ü —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è",
              "placeholder": "username",
              "defaultValue": "kaze-nomi",
              "requiredField": true
            },
            {
              "fieldLabel": "–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è",
              "placeholder": "my-repo",
              "defaultValue": "MultiAgentIntelligentSystem",
              "requiredField": true
            },
            {
              "fieldLabel": "–û—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ç–∫–∞",
              "placeholder": "main",
              "defaultValue": "main"
            }
          ]
        },
        "options": {}
      },
      "id": "59bb4484-fb83-4eb1-861e-ec4b5cb37678",
      "name": "üìù Task Input",
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.1,
      "position": [
        -4720,
        128
      ],
      "webhookId": "dev-task"
    },
    {
      "parameters": {
        "jsCode": "const form = $input.first().json;\n\nreturn [{\n  json: {\n    task_description: form['–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏'],\n    repo_owner: form['–í–ª–∞–¥–µ–ª–µ—Ü —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è'],\n    repo_name: form['–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è'],\n    base_branch: form['–û—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ç–∫–∞'] || 'main'\n  }\n}];"
      },
      "id": "39c9e0e9-f342-44f1-b852-00178e87b7f7",
      "name": "üìã Prepare Data",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -4496,
        256
      ]
    },
    {
      "parameters": {
        "url": "=https://api.github.com/repos/{{ $json.repo_owner }}/{{ $json.repo_name }}/git/trees/{{ $json.base_branch }}?recursive=1",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "options": {
          "timeout": 30000
        }
      },
      "id": "bdbb0072-fadb-4a54-89c7-934006239e61",
      "name": "üìÇ Get Repo Structure",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -4288,
        256
      ],
      "retryOnFail": true,
      "credentials": {
        "githubApi": {
          "id": "EuDjNHcUwsanYUOc",
          "name": "GitHub account"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "const formData = $('üìã Prepare Data').first().json;\nconst treeResponse = $input.first().json;\n\n// –õ–æ–≥–∏—Ä—É–µ–º –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏\nconsole.log('Tree response keys:', Object.keys(treeResponse));\nconsole.log('Tree array length:', (treeResponse.tree || []).length);\nconsole.log('First 3 items:', JSON.stringify((treeResponse.tree || []).slice(0, 3), null, 2));\n\n// –ü–∞—Ä—Å–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è\nconst structure = (treeResponse.tree || []).map(item => ({\n  path: item.path,\n  type: item.type === 'blob' ? 'file' : 'dir',\n  originalType: item.type,\n  size: item.size || 0,\n  sha: item.sha\n}));\n\n// –†–ê–°–®–ò–†–ï–ù–ù–´–ï –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤\nconst keyPatterns = [\n  /^readme\\.md$/i,\n  /^changelog\\.md$/i,\n  /^contributing\\.md$/i,\n  /^package\\.json$/,\n  /^package-lock\\.json$/,\n  /^requirements\\.txt$/,\n  /^pyproject\\.toml$/,\n  /^setup\\.py$/,\n  /^setup\\.cfg$/,\n  /^poetry\\.lock$/,\n  /^Pipfile$/,\n  /^docker-compose\\.ya?ml$/,\n  /^Dockerfile$/i,\n  /^dockerfile$/i,\n  /^\\.env\\.example$/,\n  /^\\.env\\.sample$/,\n  /^tsconfig\\.json$/,\n  /^vite\\.config\\.(js|ts)$/,\n  /^webpack\\.config\\.js$/,\n  /^next\\.config\\.(js|mjs)$/,\n  /^nuxt\\.config\\.(js|ts)$/,\n  /^\\.eslintrc(\\.(js|json|yml))?$/,\n  /^\\.prettierrc(\\.(js|json|yml))?$/,\n  /^tailwind\\.config\\.(js|ts)$/,\n  /^cargo\\.toml$/i,\n  /^go\\.mod$/,\n  /^go\\.sum$/,\n  /^makefile$/i,\n  /^justfile$/i,\n  /^main\\.(py|js|ts|go|rs)$/,\n  /^index\\.(py|js|ts|tsx|jsx)$/,\n  /^app\\.(py|js|ts|tsx|jsx)$/,\n  /^server\\.(py|js|ts)$/,\n  /^run\\.(py|js|ts)$/,\n  /^cli\\.(py|js|ts)$/,\n  /\\.py$/,\n  /^src\\/.*\\.(js|jsx|ts|tsx)$/,\n  /^lib\\/.*\\.(js|jsx|ts|tsx)$/,\n  /^app\\/.*\\.(js|jsx|ts|tsx)$/,\n  /^pages\\/.*\\.(js|jsx|ts|tsx)$/,\n  /^components\\/.*\\.(js|jsx|ts|tsx)$/,\n  /^hooks\\/.*\\.(js|jsx|ts|tsx)$/,\n  /^utils\\/.*\\.(js|ts)$/,\n  /^helpers\\/.*\\.(js|ts)$/,\n  /^services\\/.*\\.(js|ts)$/,\n  /^api\\/.*\\.(js|ts)$/,\n  /^routes?\\/.*\\.(js|ts)$/,\n  /^controllers?\\/.*\\.(js|ts)$/,\n  /^middleware\\/.*\\.(js|ts)$/,\n  /^models?\\/.*\\.(js|ts)$/,\n  /^schemas?\\/.*\\.(js|ts)$/,\n  /^types?\\/.*\\.(ts|d\\.ts)$/,\n  /^store\\/.*\\.(js|ts)$/,\n  /^config\\/.*\\.(js|ts|json)$/,\n  /\\.go$/,\n  /\\.rs$/,\n  /\\.cpp$/,\n  /\\.cxx$/,\n  /\\.c$/,\n  /\\.java$/,\n  /build\\.gradle\\.kts$/,\n  /pom\\.xml$/,\n  /config\\/.*\\.(json|ya?ml|toml)$/,\n  /\\.github\\/workflows\\/.*\\.ya?ml$/\n];\n\n// –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –ò–°–ö–õ–Æ–ß–ï–ù–ò–Ø\nconst excludePatterns = [\n  /node_modules\\//,\n  /\\.git\\//,\n  /dist\\//,\n  /build\\//,\n  /\\.next\\//,\n  /\\.nuxt\\//,\n  /out\\//,\n  /__pycache__\\//,\n  /\\.pytest_cache\\//,\n  /\\.mypy_cache\\//,\n  /\\.ruff_cache\\//,\n  /\\.venv\\//,\n  /venv\\//,\n  /\\.env\\//,\n  /env\\//,\n  /virtualenv\\//,\n  /\\.tox\\//,\n  /\\.eggs\\//,\n  /\\.egg-info\\//,\n  /htmlcov\\//,\n  /coverage\\//,\n  /\\.coverage/,\n  /\\.cache\\//,\n  /\\.temp\\//,\n  /\\.tmp\\//,\n  /target\\//,\n  /vendor\\//,\n  /\\.idea\\//,\n  /\\.vscode\\//,\n  /\\.DS_Store/,\n  /Thumbs\\.db/,\n  /\\.log$/,\n  /\\.min\\.(js|css)$/,\n  /\\.map$/,\n  /\\.bundle\\.(js|css)$/,\n  /test_.*\\.py$/,\n  /.*_test\\.py$/,\n  /.*\\.test\\.(js|ts|jsx|tsx)$/,\n  /.*\\.spec\\.(js|ts|jsx|tsx)$/,\n  /__tests__\\//,\n  /tests?\\//\n];\n\n// –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã\nconst priorityPatterns = [\n  /^readme\\.md$/i,\n  /^package\\.json$/,\n  /^requirements\\.txt$/,\n  /^pyproject\\.toml$/,\n  /^main\\.(py|js|ts)$/,\n  /^index\\.(py|js|ts)$/,\n  /^app\\.(py|js|ts)$/,\n  /^server\\.(py|js|ts)$/,\n  /models?\\.py$/,\n  /schema\\.py$/\n];\n\nconst allFiles = structure.filter(item => {\n  if (item.type !== 'file') return false;\n  if (item.size > 100000) return false;\n  const isExcluded = excludePatterns.some(p => p.test(item.path));\n  if (isExcluded) return false;\n  const matchesKey = keyPatterns.some(p => p.test(item.path));\n  return matchesKey;\n});\n\nconst sortedFiles = allFiles.sort((a, b) => {\n  const aPriority = priorityPatterns.some(p => p.test(a.path)) ? 0 : 1;\n  const bPriority = priorityPatterns.some(p => p.test(b.path)) ? 0 : 1;\n  if (aPriority !== bPriority) return aPriority - bPriority;\n  return a.size - b.size;\n});\n\nconst filesToFetch = sortedFiles.slice(0, 50);\n\n// –°–æ—Ö—Ä–∞–Ω—è–µ–º SHA –¥–ª—è –í–°–ï–• —Ñ–∞–π–ª–æ–≤\nconst existingFileShas = {};\nstructure.forEach(item => {\n  if (item.type === 'file') {\n    existingFileShas[item.path] = item.sha;\n  }\n});\n\nconsole.log('=== FINAL STATS ===');\nconsole.log(`Total items in structure: ${structure.length}`);\nconsole.log(`Total files: ${structure.filter(i => i.type === 'file').length}`);\nconsole.log(`Files matching patterns: ${allFiles.length}`);\nconsole.log(`Files to fetch: ${filesToFetch.length}`);\n\nreturn [{\n  json: {\n    ...formData,\n    structure: structure,\n    files_to_fetch: filesToFetch,\n    existing_file_shas: existingFileShas,\n    stats: {\n      total_files: structure.filter(i => i.type === 'file').length,\n      matching_files: allFiles.length,\n      files_to_fetch: filesToFetch.length\n    }\n  }\n}];"
      },
      "id": "ff5eaf31-b7bc-4822-8419-5fd077e75c42",
      "name": "üîç Analyze Structure",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -4064,
        128
      ]
    },
    {
      "parameters": {
        "jsCode": "const data = $input.first().json;\nconst filesToFetch = data.files_to_fetch || [];\n\nif (filesToFetch.length === 0) {\n  return [{ json: { ...data, skip_fetch: true } }];\n}\n\nreturn filesToFetch.map(file => ({\n  json: { ...data, file_path: file.path, file_sha: file.sha }\n}));"
      },
      "id": "8c815f38-6357-4565-a54d-04152e48a1dd",
      "name": "üìÑ Split Files",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -3840,
        128
      ]
    },
    {
      "parameters": {
        "url": "=https://api.github.com/repos/{{ $json.repo_owner }}/{{ $json.repo_name }}/contents/{{ $json.file_path }}?ref={{ $json.base_branch }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "options": {
          "batching": {
            "batch": {
              "batchSize": 1
            }
          },
          "timeout": 20000
        }
      },
      "id": "13ad326e-4ffc-4416-b3ff-7fd2c277b527",
      "name": "üì• Fetch Contents",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -3616,
        128
      ],
      "retryOnFail": true,
      "credentials": {
        "githubApi": {
          "id": "EuDjNHcUwsanYUOc",
          "name": "GitHub account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\nconst firstItem = $('üîç Analyze Structure').first().json;\n\nconst keyFiles = {};\nlet loaded = 0, failed = 0;\n\nitems.forEach(item => {\n  if (item.json.skip_fetch) return;\n  try {\n    const content = item.json.content;\n    const path = item.json.path || item.json.name;\n    if (content && path) {\n      keyFiles[path] = Buffer.from(content, 'base64').toString('utf-8');\n      loaded++;\n    }\n  } catch (e) { failed++; }\n});\n\nreturn [{\n  json: {\n    task_description: firstItem.task_description,\n    repo_owner: firstItem.repo_owner,\n    repo_name: firstItem.repo_name,\n    base_branch: firstItem.base_branch,\n    existing_file_shas: firstItem.existing_file_shas,\n    repo_context: { structure: firstItem.structure, key_files: keyFiles },\n    files_loaded: loaded\n  }\n}];"
      },
      "id": "007f2538-bc30-490d-85f4-fcea38bf93f2",
      "name": "üì¶ Aggregate Contents",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -3408,
        128
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://project-manager:8000/workflow/process",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ task_description: $json.task_description, repo_owner: $json.repo_owner, repo_name: $json.repo_name, base_branch: $json.base_branch, repo_context: $json.repo_context, priority: 'high', max_review_iterations: 3 }) }}",
        "options": {
          "timeout": 10000000
        }
      },
      "id": "0c996e90-6a06-4a84-84a1-1a523e750617",
      "name": "ü§ñ Call Project Manager",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -3184,
        128
      ]
    },
    {
      "parameters": {
        "jsCode": "const aggregateData = $('üì¶ Aggregate Contents').first().json;\nconst pmResponse = $input.first().json;\n\nif (pmResponse.status === 'failed') {\n  const errors = pmResponse.errors || [];\n  const agentResults = pmResponse.agent_results || {};\n  \n  let errorDetails = 'Pipeline failed:\\n';\n  \n  if (agentResults.code_writer) {\n    const cw = agentResults.code_writer;\n    if (!cw.files || cw.files.length === 0) {\n      errorDetails += '‚ùå Code Writer: No files generated\\n';\n      if (cw.implementation_notes) {\n        errorDetails += `   Notes: ${cw.implementation_notes.join(', ')}\\n`;\n      }\n    }\n  }\n  \n  errors.forEach(e => {\n    errorDetails += `‚ùå ${e.step}: ${e.error}\\n`;\n  });\n}\n\nconst files = pmResponse.files_to_create || [];\nif (files.length === 0) {\n  $input.first().json.status = 'failed';\n}\n\nreturn [{\n  json: {\n    ...pmResponse,\n    repo_owner: aggregateData.repo_owner,\n    repo_name: aggregateData.repo_name,\n    base_branch: aggregateData.base_branch,\n    existing_file_shas: aggregateData.existing_file_shas\n  }\n}];"
      },
      "id": "92c5af96-3b3a-42cf-ae74-735d35095ce1",
      "name": "‚úÖ Check PM Response",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2960,
        128
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": false,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 1
          },
          "conditions": [
            {
              "leftValue": "={{ $json.status }}",
              "rightValue": "failed",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              },
              "id": "2c921d36-eed4-45a6-8451-1939794200a1"
            },
            {
              "id": "2d422828-3a90-4be4-83b0-04d98231e755",
              "leftValue": "={{ $json.status }}",
              "rightValue": "error",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {
          "ignoreCase": true,
          "looseTypeValidation": true
        }
      },
      "id": "81efa7a0-c3fc-43c1-88e9-be4e737948bd",
      "name": "üîÄ Is Success?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -2768,
        128
      ]
    },
    {
      "parameters": {
        "url": "=https://api.github.com/repos/{{ $json.repo_owner }}/{{ $json.repo_name }}/git/refs/heads/{{ $json.base_branch }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "options": {}
      },
      "id": "9d788440-7434-4d10-ac02-48bddcee20be",
      "name": "üîó Get Base SHA",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2496,
        0
      ],
      "retryOnFail": true,
      "credentials": {
        "githubApi": {
          "id": "EuDjNHcUwsanYUOc",
          "name": "GitHub account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const pmData = $('‚úÖ Check PM Response').first().json;\nconst shaResponse = $input.first().json;\n\nreturn [{ json: { ...pmData, base_sha: shaResponse.object.sha } }];"
      },
      "id": "1ada7048-fffd-4081-8466-62eedb6e97c8",
      "name": "Extract SHA",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2288,
        0
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.github.com/repos/{{ $json.repo_owner }}/{{ $json.repo_name }}/git/refs",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ ref: 'refs/heads/' + $json.branch_name, sha: $json.base_sha }) }}",
        "options": {}
      },
      "id": "9276df3c-fc70-458c-a339-2e0c3ebaf2a4",
      "name": "üåø Create Branch",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2064,
        0
      ],
      "retryOnFail": true,
      "credentials": {
        "githubApi": {
          "id": "EuDjNHcUwsanYUOc",
          "name": "GitHub account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// =====================================================\n// üîß –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø RETRY LOOP\n// =====================================================\nconst data = $('Extract SHA').first().json;\nconst files = data.files_to_create || [];\nconst existingShas = data.existing_file_shas || {};\n\nif (files.length === 0) {\n  throw new Error('No files to create!');\n}\n\n// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è retry\nconst filesToProcess = files.map((file, index) => {\n  const existingSha = existingShas[file.path];\n  return {\n    path: file.path,\n    content: file.content || '',\n    action: file.action || 'create',\n    source_agent: file.source_agent || 'unknown',\n    existing_sha: existingSha || null,\n    status: 'pending',  // pending, success, failed\n    attempts: 0,\n    last_error: null\n  };\n});\n\nreturn [{\n  json: {\n    repo_owner: data.repo_owner,\n    repo_name: data.repo_name,\n    branch_name: data.branch_name,\n    base_branch: data.base_branch,\n    commit_message: data.commit_message,\n    pr_title: data.pr_title,\n    pr_description: data.pr_description,\n    summary: data.summary,\n    task_id: data.task_id,\n    tech_stack: data.tech_stack,\n    review_iterations: data.review_iterations,\n    agent_results: data.agent_results,\n    // Retry state\n    files_to_process: filesToProcess,\n    created_files: [],  // –£—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ\n    failed_files: [],   // –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ failed\n    current_attempt: 1,\n    max_attempts: 3\n  }\n}];"
      },
      "id": "ba761a85-7edf-48c0-bece-28f9316f4a53",
      "name": "üîÑ Init Retry Loop",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1840,
        0
      ]
    },
    {
      "parameters": {
        "jsCode": "// =====================================================\n// üìÑ SPLIT: –ü–æ–ª—É—á–∞–µ–º pending —Ñ–∞–π–ª—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏\n// =====================================================\nconst data = $input.first().json;\nconst pendingFiles = data.files_to_process.filter(f => f.status === 'pending');\n\nconsole.log(`Attempt ${data.current_attempt}/${data.max_attempts}: ${pendingFiles.length} files to process`);\n\nif (pendingFiles.length === 0) {\n  // –í—Å–µ —Ñ–∞–π–ª—ã –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã - –∏–¥—ë–º –¥–∞–ª—å—à–µ\n  return [{ json: { ...data, all_processed: true } }];\n}\n\n// –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ items –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏\nreturn pendingFiles.map(file => ({\n  json: {\n    ...data,\n    current_file: file,\n    all_processed: false\n  }\n}));"
      },
      "id": "48a31a18-a582-40d1-917a-5c74dcb0118a",
      "name": "üìÑ Split Pending Files",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1616,
        0
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "id": "check-all-processed",
              "leftValue": "={{ $json.all_processed }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "77bd6619-f1f2-4692-ae9f-a1669c807440",
      "name": "üîÄ All Processed?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -1424,
        0
      ]
    },
    {
      "parameters": {
        "url": "=https://api.github.com/repos/{{ $json.repo_owner }}/{{ $json.repo_name }}/contents/{{ $json.current_file.path }}?ref={{ $json.branch_name }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "options": {
          "timeout": 15000
        }
      },
      "id": "16bbfb1c-92e7-4752-b8b9-f81fe9708359",
      "name": "üîç Get File SHA",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1152,
        112
      ],
      "alwaysOutputData": false,
      "retryOnFail": false,
      "credentials": {
        "githubApi": {
          "id": "EuDjNHcUwsanYUOc",
          "name": "GitHub account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "// =====================================================\n// üìù PREPARE: –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è PUT\n// –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ö–ê–ñ–î–´–ô item –æ—Ç–¥–µ–ª—å–Ω–æ!\n// =====================================================\n\nconst item = $('üìÑ Split Pending Files').item;\nlet file = $json;\nconst data = item.json;\n  \n// –û–ø—Ä–µ–¥–µ–ª—è–µ–º SHA —Ñ–∞–π–ª–∞\nlet fileSha = null;\n// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤–µ—Ä–Ω—É–ª –ª–∏ GitHub SHA (—Ñ–∞–π–ª —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞ –≤–µ—Ç–∫–µ)\nif (file.sha) {\n  fileSha = file.sha;\n  console.log(`File exists on branch: ${file.path}, SHA: ${fileSha}`);\n}\n// –ù–æ–≤—ã–π —Ñ–∞–π–ª\nelse {\n  console.log(`New file: ${file.path}`);\n}\n\n// –ö–æ–¥–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –≤ base64\nconst contentBase64 = Buffer.from(data.current_file.content || '').toString('base64');\n\n// –í–æ–∑–≤—Ä–∞—â–∞–µ–º item —Å –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏\nlet result = ({\n  json: {\n    // –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ\n    repo_owner: data.repo_owner,\n    repo_name: data.repo_name,\n    branch_name: data.branch_name,\n    base_branch: data.base_branch,\n    commit_message: data.commit_message,\n    pr_title: data.pr_title,\n    pr_description: data.pr_description,\n    summary: data.summary,\n    task_id: data.task_id,\n    tech_stack: data.tech_stack,\n    review_iterations: data.review_iterations,\n    agent_results: data.agent_results,\n    files_to_process: data.files_to_process,\n    created_files: data.created_files,\n    failed_files: data.failed_files,\n    current_attempt: data.current_attempt,\n    max_attempts: data.max_attempts,\n    \n    // –¢–µ–∫—É—â–∏–π —Ñ–∞–π–ª —Å resolved SHA\n    current_file: {\n      ...file,\n      resolved_sha: fileSha\n    },\n    \n    // –î–∞–Ω–Ω—ã–µ –¥–ª—è PUT –∑–∞–ø—Ä–æ—Å–∞\n    file_path: data.current_file.path,\n    file_content_base64: contentBase64,\n    file_sha: fileSha\n}});\n\nreturn result;"
      },
      "id": "7a60b43a-03ee-41f5-9dde-96c391c778e5",
      "name": "üìù Prepare PUT Data",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -928,
        112
      ]
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://api.github.com/repos/{{ $json.repo_owner }}/{{ $json.repo_name }}/contents/{{ $json.file_path}}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ (() => {\n  const body = {\n    message: $json.commit_message + ' [' + $json.file_path.split('/').pop() + ']',\n    content: $json.file_content_base64,\n    branch: $json.branch_name\n  };\n  if ($json.file_sha) {\n    body.sha = $json.file_sha;\n  }\n  return JSON.stringify(body);\n})() }}",
        "options": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 2000
            }
          },
          "timeout": 30000
        }
      },
      "id": "f1b54890-f421-4e20-8f30-dda386aa88ff",
      "name": "üíæ Create/Update File",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -704,
        112
      ],
      "credentials": {
        "githubApi": {
          "id": "EuDjNHcUwsanYUOc",
          "name": "GitHub account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// =====================================================\n// üìä PROCESS RESULT: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç PUT\n// =====================================================\nconst items = $input.all();\nconst firstData = $('üìÑ Split Pending Files').first().json;\n\n// –°–æ–±–∏—Ä–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã\nconst results = items.map(item => {\n  const data = item.json;\n  const path = data?.content?.path || null;\n  \n  \n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ø–µ—Ö\n  if (data.content && data.commit) {\n    return { path, status: 'success', sha: data.content.sha };\n  } else {\n    const error = data.message || data.error || 'Unknown error';\n    return { path, status: 'failed', error };\n  }\n});\n\nconsole.log(results);\n\n// –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–∞–π–ª–æ–≤\nconst updatedFiles = firstData.files_to_process.map(f => {\n  if (f.status != 'success') {\n    const result = results.find(r => r.path === f.path);\n    if (result) {\n      if (result.status === 'success') {\n        return { ...f, status: 'success', new_sha: result.sha };\n      }\n    } else {\n      return {\n        ...f,\n        attempts: f.attempts + 1,\n        status: f.attempts + 1 >= firstData.max_attempts ? 'failed' : 'pending'    \n      }\n    }\n  } else {\n    return {\n      ...f\n    }\n  }\n});\n\n// –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É\nconst successCount = updatedFiles.filter(f => f.status === 'success').length;\nconst pendingCount = updatedFiles.filter(f => f.status === 'pending').length;\nconst failedCount = updatedFiles.filter(f => f.status === 'failed').length;\n\nconsole.log(`After attempt ${firstData.current_attempt}: success=${successCount}, pending=${pendingCount}, failed=${failedCount}`);\n\n// –ï—Å–ª–∏ –µ—Å—Ç—å pending —Ñ–∞–π–ª—ã –∏ –Ω–µ –ø—Ä–µ–≤—ã—Å–∏–ª–∏ –ª–∏–º–∏—Ç –ø–æ–ø—ã—Ç–æ–∫ - –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º\nconst needRetry = pendingCount > 0 && firstData.current_attempt < firstData.max_attempts;\n\nreturn [{\n  json: {\n    repo_owner: firstData.repo_owner,\n    repo_name: firstData.repo_name,\n    branch_name: firstData.branch_name,\n    base_branch: firstData.base_branch,\n    commit_message: firstData.commit_message,\n    pr_title: firstData.pr_title,\n    pr_description: firstData.pr_description,\n    summary: firstData.summary,\n    task_id: firstData.task_id,\n    tech_stack: firstData.tech_stack,\n    review_iterations: firstData.review_iterations,\n    agent_results: firstData.agent_results,\n    files_to_process: updatedFiles,\n    current_attempt: firstData.current_attempt + 1,\n    max_attempts: firstData.max_attempts,\n    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n    success_count: successCount,\n    pending_count: pendingCount,\n    failed_count: failedCount,\n    need_retry: needRetry,\n    all_done: !needRetry\n  }\n}];"
      },
      "id": "150ec1bd-bd3e-490a-ba92-c45be96dde87",
      "name": "üìä Process Results",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -480,
        112
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "id": "need-retry",
              "leftValue": "={{ $json.need_retry }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "adc8bf31-0d78-41b8-8b7c-5c41e69cf0d7",
      "name": "üîÄ Need Retry?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -256,
        112
      ]
    },
    {
      "parameters": {
        "jsCode": "// =====================================================\n// ‚è≥ WAIT: –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ retry\n// =====================================================\nconst data = $input.first().json;\n\nconsole.log(`Waiting before retry attempt ${data.current_attempt}...`);\n\n// –ü—Ä–æ—Å—Ç–æ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–∞–ª—å—à–µ\nreturn [{ json: data }];"
      },
      "id": "76d27eed-9833-4173-81a3-a5fa9c443181",
      "name": "‚è≥ Wait & Retry",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -48,
        -208
      ]
    },
    {
      "parameters": {
        "jsCode": "// =====================================================\n// ‚úÖ FINALIZE: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤\n// =====================================================\nconst data = $input.first().json;\nconst files = data.files_to_process || [];\n\nconst successFiles = files.filter(f => f.status === 'success');\nconst failedFiles = files.filter(f => f.status === 'failed');\n\nconsole.log(`Final: ${successFiles.length} success, ${failedFiles.length} failed`);\n\n// –ï—Å–ª–∏ –µ—Å—Ç—å failed —Ñ–∞–π–ª—ã - —ç—Ç–æ –æ—à–∏–±–∫–∞\nconst hasErrors = failedFiles.length > 0;\n\nreturn [{\n  json: {\n    ...data,\n    files_created: successFiles.length,\n    files_failed: failedFiles.length,\n    success_files: successFiles.map(f => f.path),\n    failed_files_details: failedFiles.map(f => ({\n      path: f.path,\n      error: f.last_error,\n      attempts: f.attempts\n    })),\n    has_errors: hasErrors,\n    can_create_pr: successFiles.length > 0  // PR –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –µ—Å–ª–∏ —Ö–æ—Ç—å —á—Ç–æ-—Ç–æ —Å–æ–∑–¥–∞–ª–æ—Å—å\n  }\n}];"
      },
      "id": "6691c9b4-ec7d-4472-a607-a8a83da14459",
      "name": "‚úÖ Finalize Results",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -48,
        0
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "id": "can-pr",
              "leftValue": "={{ $json.can_create_pr }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "d0cfec94-3b44-4bab-a7a6-c7c48ec4ac4d",
      "name": "üîÄ Can Create PR?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        176,
        0
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.github.com/repos/{{ $json.repo_owner }}/{{ $json.repo_name }}/pulls",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ title: $json.pr_title, head: $json.branch_name, base: $json.base_branch, body: $json.pr_description }) }}",
        "options": {}
      },
      "id": "89d25cac-f6d9-4bbd-9f17-67f145dc6c08",
      "name": "üîÄ Create PR",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        400,
        -128
      ],
      "retryOnFail": true,
      "credentials": {
        "githubApi": {
          "id": "EuDjNHcUwsanYUOc",
          "name": "GitHub account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const data = $('‚úÖ Finalize Results').first().json;\nconst pr = $input.first().json;\n\nlet msg = `${data.summary}\\n\\n`;\n\nmsg += `\\nüîó [Pull Request #${pr.number}](${pr.html_url})`;\n\nreturn [{ json: { message: msg } }];"
      },
      "id": "bb4aaaaa-e415-48d2-8182-c38eb34ed8f3",
      "name": "üì± Success Message",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        624,
        -128
      ]
    },
    {
      "parameters": {
        "jsCode": "const data = $input.first().json;\n\nlet msg = `‚ùå *–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤*\\n\\n`;\nmsg += `–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –Ω–∏ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –ø–æ—Å–ª–µ ${data.max_attempts} –ø–æ–ø—ã—Ç–æ–∫.\\n\\n`;\n\nmsg += `üìÅ *–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã:*\\n`;\ndata.failed_files_details.forEach(f => {\n  msg += `‚Ä¢ \\`${f.path}\\`\\n`;\n  msg += `  –û—à–∏–±–∫–∞: ${f.error}\\n`;\n  msg += `  –ü–æ–ø—ã—Ç–æ–∫: ${f.attempts}\\n\\n`;\n});\n\nmsg += `\\nüí° *–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:*\\n`;\nmsg += `‚Ä¢ –§–∞–π–ª –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω\\n`;\nmsg += `‚Ä¢ –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞\\n`;\nmsg += `‚Ä¢ Rate limit GitHub API\\n`;\n\nreturn [{ json: { message: msg } }];"
      },
      "id": "2379f190-099e-469b-b4fd-c049a143017d",
      "name": "üì± Total Failure Message",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        400,
        128
      ]
    },
    {
      "parameters": {
        "chatId": "=6487984216",
        "text": "={{ $json.message }}",
        "additionalFields": {
          "appendAttribution": false,
          "disable_web_page_preview": true,
          "parse_mode": "Markdown"
        }
      },
      "id": "472299ef-f78c-43a2-8b56-e243caa2fb6b",
      "name": "üì§ Send Success",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        848,
        -128
      ],
      "webhookId": "482d72a6-9720-44e2-a67f-b1bbd47b3c28",
      "credentials": {
        "telegramApi": {
          "id": "kakDfZD7GZ0uQLva",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "=6487984216",
        "text": "={{ $json.message }}",
        "additionalFields": {
          "appendAttribution": false,
          "parse_mode": "Markdown"
        }
      },
      "id": "c492e3b3-76ad-46fc-81d1-4e3df51c21ce",
      "name": "üì§ Send Failure",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        624,
        128
      ],
      "webhookId": "4568e073-12f9-47c2-87c3-1391871d6192",
      "credentials": {
        "telegramApi": {
          "id": "kakDfZD7GZ0uQLva",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const data = $('‚úÖ Check PM Response').first().json;\n\nlet msg = `‚ùå *Pipeline Failed*\\n\\n`;\nmsg += `${data.summary || 'No summary available'}\\n\\n`;\n\nif (data.errors) {\n  msg += `*–û—à–∏–±–∫–∏:*\\n`;\n  data.errors.forEach(e => {\n    msg += `‚Ä¢ ${e.step}: ${e.error}\\n`;\n  });\n}\n\nreturn [{ json: { message: msg } }];"
      },
      "id": "3a8dc332-cf88-4f5e-81f0-2ba6822ed9ca",
      "name": "üì± PM Error Message",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2496,
        256
      ]
    },
    {
      "parameters": {
        "chatId": "=6487984216",
        "text": "={{ $json.message }}",
        "additionalFields": {
          "appendAttribution": false,
          "parse_mode": "Markdown"
        }
      },
      "id": "b26c799f-e553-4fd0-b840-084d661358f6",
      "name": "üì§ Send PM Error",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -2288,
        256
      ],
      "webhookId": "78218e0c-a817-4c73-8001-40d02bbf6cf0",
      "credentials": {
        "telegramApi": {
          "id": "kakDfZD7GZ0uQLva",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {},
      "id": "8b94ded7-ecae-4a6d-b270-d57321adbe88",
      "name": "‚úÖ End Success",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        1072,
        -128
      ]
    },
    {
      "parameters": {},
      "id": "594fd35b-89b8-453f-84c2-74f36e48e084",
      "name": "‚ùå End Failure",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        848,
        128
      ]
    },
    {
      "parameters": {
        "jsCode": "const message = $input.first().json.message || $input.first().json.edited_message;\n\n// –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –µ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ\nif (!message || !message.text) {\n  throw new Error(\"–°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç–∞!\");\n}\n\nconst text = message.text.trim();\nconst chatId = message.chat.id;\n\n// –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å /task\nif (!text.startsWith('/task')) {\n  throw new Error(`–ö–æ–º–∞–Ω–¥–∞ –¥–æ–ª–∂–Ω–∞ –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å /task\\n–ü—Ä–∏–º–µ—Ä—ã:\\n/task –∏—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–≥\\n/task myrepo: –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é`);\n}\n\n// –£–±–∏—Ä–∞–µ–º –∫–æ–º–∞–Ω–¥—É /task –∏ –≤–æ–∑–º–æ–∂–Ω–æ–µ –∏–º—è –±–æ—Ç–∞ (/task@botname)\nlet commandText = text.replace(/^\\/task(@\\w+)?\\s*/i, '');\n\n// –ï—Å–ª–∏ –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∏—á–µ–≥–æ –Ω–µ—Ç\nif (!commandText.trim()) {\n  throw new Error(\"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –∑–∞–¥–∞—á—É –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã /task\\n–ü—Ä–∏–º–µ—Ä: /task –∏—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–≥ –≤ –ª–æ–≥–∏–∫–µ\");\n}\n\nlet repo_name, task_description;\n\n// –ü–∞—Ä—Å–∏–º: –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç \"—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏\"\nif (commandText.includes(':')) {\n  // –ù–∞—Ö–æ–¥–∏–º –ø–µ—Ä–≤–æ–µ –¥–≤–æ–µ—Ç–æ—á–∏–µ\n  const colonIndex = commandText.indexOf(':');\n  \n  // –ß–∞—Å—Ç—å –¥–æ –¥–≤–æ–µ—Ç–æ—á–∏—è - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è\n  repo_name = commandText.substring(0, colonIndex).trim();\n  \n  // –ß–∞—Å—Ç—å –ø–æ—Å–ª–µ –¥–≤–æ–µ—Ç–æ—á–∏—è - –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏\n  task_description = commandText.substring(colonIndex + 1).trim();\n  \n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –ø—É—Å—Ç–æ–π\n  if (!repo_name) {\n    repo_name = 'MultiAgentIntelligentSystem';\n  }\n} else {\n  // –ï—Å–ª–∏ –¥–≤–æ–µ—Ç–æ—á–∏—è –Ω–µ—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π\n  repo_name = 'MultiAgentIntelligentSystem';\n  task_description = commandText.trim();\n}\n\n// –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –Ω–µ –ø—É—Å—Ç–æ–µ\nif (!task_description) {\n  throw new Error(\"–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º!\\n–ü—Ä–∏–º–µ—Ä: /task –∏—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–≥ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—à–∏–±–æ–∫\");\n}\n\n// –û—á–∏—â–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –æ—Ç –ª–∏—à–Ω–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–±–µ–ª—ã –≤ –æ–ø–∏—Å–∞–Ω–∏–∏\nrepo_name = repo_name.replace(/[^\\w\\-\\.]/g, '');\n\nreturn [{\n  json: {\n    task_description: task_description,\n    repo_owner: 'kaze-nomi',\n    repo_name: repo_name,\n    base_branch: 'main',\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -4720,
        384
      ],
      "id": "98f96c43-7835-400b-9410-500f17e73234",
      "name": "üì± Parse Telegram Message",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "chatId": "6487984216",
        "text": "=–û—à–∏–±–∫–∞:\n\n{{ $json }}",
        "replyMarkup": "inlineKeyboard",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -4496,
        512
      ],
      "id": "69f5fba3-334d-4c14-a506-bdbecc474500",
      "name": "üì§ Send Parsing Error",
      "webhookId": "69b3135d-f2a2-4377-89bc-f94e6ecc34a6",
      "credentials": {
        "telegramApi": {
          "id": "kakDfZD7GZ0uQLva",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "6487984216",
        "text": "={{ $input.first().json }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -4064,
        384
      ],
      "id": "5ba86223-8342-4019-a622-350284ef72d5",
      "name": "üì§ Send GitHub error",
      "webhookId": "69b3135d-f2a2-4377-89bc-f94e6ecc34a6",
      "credentials": {
        "telegramApi": {
          "id": "kakDfZD7GZ0uQLva",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {
          "chatIds": "6487984216"
        }
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        -4944,
        384
      ],
      "id": "37b378e6-22ae-4152-b703-47db850873ff",
      "name": "üöÄ Telegram Trigger",
      "webhookId": "9cb6dd03-4e32-4275-83f9-a96c38719a44",
      "credentials": {
        "telegramApi": {
          "id": "kakDfZD7GZ0uQLva",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {},
      "id": "99d98018-34f9-48d7-988e-6f6b856a2273",
      "name": "‚ùå End PM Failure",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        -2064,
        256
      ]
    },
    {
      "parameters": {},
      "id": "54f4ad66-6046-40d5-997a-af53404b20b4",
      "name": "‚ùå End GitHub Failure",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        -3840,
        384
      ]
    },
    {
      "parameters": {},
      "id": "ada68389-5fb4-466f-947e-69956b368a14",
      "name": "‚ùå Telegram Input Failure",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        -4288,
        512
      ]
    }
  ],
  "pinData": {},
  "connections": {
    "üìù Task Input": {
      "main": [
        [
          {
            "node": "üìã Prepare Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìã Prepare Data": {
      "main": [
        [
          {
            "node": "üìÇ Get Repo Structure",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìÇ Get Repo Structure": {
      "main": [
        [
          {
            "node": "üîç Analyze Structure",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "üì§ Send GitHub error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîç Analyze Structure": {
      "main": [
        [
          {
            "node": "üìÑ Split Files",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìÑ Split Files": {
      "main": [
        [
          {
            "node": "üì• Fetch Contents",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì• Fetch Contents": {
      "main": [
        [
          {
            "node": "üì¶ Aggregate Contents",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì¶ Aggregate Contents": {
      "main": [
        [
          {
            "node": "ü§ñ Call Project Manager",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ü§ñ Call Project Manager": {
      "main": [
        [
          {
            "node": "‚úÖ Check PM Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "‚úÖ Check PM Response": {
      "main": [
        [
          {
            "node": "üîÄ Is Success?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîÄ Is Success?": {
      "main": [
        [
          {
            "node": "üîó Get Base SHA",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "üì± PM Error Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîó Get Base SHA": {
      "main": [
        [
          {
            "node": "Extract SHA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract SHA": {
      "main": [
        [
          {
            "node": "üåø Create Branch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üåø Create Branch": {
      "main": [
        [
          {
            "node": "üîÑ Init Retry Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîÑ Init Retry Loop": {
      "main": [
        [
          {
            "node": "üìÑ Split Pending Files",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìÑ Split Pending Files": {
      "main": [
        [
          {
            "node": "üîÄ All Processed?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîÄ All Processed?": {
      "main": [
        [
          {
            "node": "‚úÖ Finalize Results",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "üîç Get File SHA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîç Get File SHA": {
      "main": [
        [
          {
            "node": "üìù Prepare PUT Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìù Prepare PUT Data": {
      "main": [
        [
          {
            "node": "üíæ Create/Update File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üíæ Create/Update File": {
      "main": [
        [
          {
            "node": "üìä Process Results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìä Process Results": {
      "main": [
        [
          {
            "node": "üîÄ Need Retry?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîÄ Need Retry?": {
      "main": [
        [
          {
            "node": "‚è≥ Wait & Retry",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "‚úÖ Finalize Results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "‚è≥ Wait & Retry": {
      "main": [
        [
          {
            "node": "üìÑ Split Pending Files",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "‚úÖ Finalize Results": {
      "main": [
        [
          {
            "node": "üîÄ Can Create PR?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîÄ Can Create PR?": {
      "main": [
        [
          {
            "node": "üîÄ Create PR",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "üì± Total Failure Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîÄ Create PR": {
      "main": [
        [
          {
            "node": "üì± Success Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì± Success Message": {
      "main": [
        [
          {
            "node": "üì§ Send Success",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì± Total Failure Message": {
      "main": [
        [
          {
            "node": "üì§ Send Failure",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì§ Send Success": {
      "main": [
        [
          {
            "node": "‚úÖ End Success",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì§ Send Failure": {
      "main": [
        [
          {
            "node": "‚ùå End Failure",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì± PM Error Message": {
      "main": [
        [
          {
            "node": "üì§ Send PM Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì§ Send PM Error": {
      "main": [
        [
          {
            "node": "‚ùå End PM Failure",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì± Parse Telegram Message": {
      "main": [
        [
          {
            "node": "üìã Prepare Data",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "üì§ Send Parsing Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üöÄ Telegram Trigger": {
      "main": [
        [
          {
            "node": "üì± Parse Telegram Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì§ Send GitHub error": {
      "main": [
        [
          {
            "node": "‚ùå End GitHub Failure",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì§ Send Parsing Error": {
      "main": [
        [
          {
            "node": "‚ùå Telegram Input Failure",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "c34af814-6bd6-4955-8905-6a48b34fefc0",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "28f87a46502090a63d81c1b0d194b30cb85aa507eb30004f35c39d5a49ec1f61"
  },
  "id": "q5zbLyvM2G174cvL",
  "tags": []
}